<!DOCTYPE html>
<!--Template: https://www.w3schools.com/bootstrap/tryit.asp?filename=trybs_temp_webpage&stacked=h  -->
<html lang="en">
<head>
  <title>Concepts Behind Rendering Diffraction</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- replace with our own css? -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="../../css/topics/topic.css">
  <!-- mathjax needed to display equations, just write them like in LaTeX-->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
    });
  </script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML'></script>
  <!-- end of mathjax configuration -->
</head>
<body>

<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="collapse navbar-collapse" id="myNavbar">
      <ul class="nav navbar-nav">
        <!-- <li class="active"><a href="#">Home</a></li> -->
        <li><a href="../../index.html">Home</a></li>
        <li>
        <li class="dropdown">
          <a class="dropbtn">Menu</a>
          <div class="dropdown-content">
            <a href="https://www.doc.ic.ac.uk/~imm1117/">Link 1</a>
            <a href="https://www.doc.ic.ac.uk/~imm1117/">Link 2</a>
            <a href="https://www.doc.ic.ac.uk/~imm1117/">Link 3</a>
          </div>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="../../cv/HannahCV/index.html">About</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="container-fluid text-center">
  <div class="row content" >
    <div class="col-sm-2 sidenav">
      <!-- <p><a href="#">Link</a></p>
      <p><a href="#">Link</a></p>
      <p><a href="#">Link</a></p> -->
    </div>
    <div class="col-sm-8 text-left">
      <h1>Concepts Behind Rendering Diffraction</h1>
      <p>
        When light hits a surface, some of it is reflected back into the environment.
        Inorder to simplfy modelling this process we make the following assumptions [<a href="#Pharr54">1</a>]:
        </p>
        <ul>
          <li class = "spaced">
            <b>Linearity</b>: Two inputs combined have the same effect on the optical system
            as there indivdual consequences combined.
          </li>
          <li class = "spaced">
            <b>Energy conservation</b>: The amount of scattered light is less than or equal
            to the amount of light that hit the surface.
          </li>
          <li class = "spaced">
            <b>No polarization</b>: Hence, light can be described only by its wavelength.
          </li>
          <li class = "spaced">
            <b>No flourescence or phosphorescence</b>:
            Therefore, light of different wavelengths and at different times can
            be consider seperately. As the surface cannot store the light or
            emit light of other wavelengths.
          </li>
        </ul>
      </p>
      <p>
        We will now consider the directional distribution of light reflected
        from a surface.
        <!-- There are two main aspects to consider: the directional distribution and the spectral distribution. -->
      </p>
      <hr>
      <section id="brdf">
        <h2> Bidirectional Reflectance Distribution Function</h2>
        <p class="text-body text">
          A bidirectional reflectance distribution function describes the directional distribution of
          reflected light from a surface. It is a central part of a rendering program. Lets first consider
          some of the required physical quantities:
        </p>
        <ul>
          <li class = "spaced">
            <b> Energy </b>: The photons of light with wavelength $\lambda$ each have the energy
            $ Q = \dfrac{hc}{\lambda}$
            where $h \approx 6.626\times 10^{-34} \frac{m^2 kg}{s}$ is Plank's constant
            and $c \approx 2.9979\times 10^8 \frac{m}{s}$ is the speed of light.
          </li>
          <li class = "spaced">
            <b> Flux </b>: The amount of light passing through an area per time is given
            is given by the flux $ \Phi = \dfrac{dQ}{dt}$ where $Q$ is the energy of the light.
          </li>
          <li class = "spaced">
            <b> Irradiance </b>: The density of flux arriving at or reflected by a surface is called irradiance.
            We write $E = \dfrac{\Phi}{A}$ where $A$ is the area of the surface and $\Phi$ the flux at the surface or $E = \dfrac{d\Phi(p)}{dA}$
            where $p$ is a point on the surface.
          </li>
        </ul>
        <p>
          It is important to note that in the definition of irradiance above, the area $A$ is
          measured with respect to the surface. If the direction of the light is orthogonal to
          the surface, $A^\bot$ measured perpendicular to the path of the light
          is the same as $A$ on the surface. Otherwise we need to apply <b> Lambert's Law: </b>
        </p>

        <div class="imagebox" style="width:45%">
          <img src="../../img/hannah/lambert.png" alt="Lambert's Law">
          <div class="container" style="width:100%">
            <hr>
            <p>Lambert's Law: $ E = \dfrac{\Phi}{A} = \dfrac{\Phi\; cos\; \theta}{A^\bot} $</p>
          </div>
        </div>

        <p>
          There is one more quatity we need to define, before we can introduce the BRDF.
          The radiance will relate the irradiance to the direction of the light. As
          we are dealing with three-dimensional space, we use solid angles to describe
          the direction of the light.
        </p>
        <p>
          Solid angles are the three-dimensional analogue of angles we know from plane
          geometry. They are measured in steradians ($sr$). A unit sphere has $4\pi\; sr$
          and the solid angle of an object at a vertex is the area of its projection
          onto a unit sphere around that vertex.
        </p>
        <p>
          Let $\omega$ now denote the direction of the light and $E_\omega$ the irradiance
          at a surface perpendicular to $\omega$. Then the <b> radiance </b> at a point $p$
          is defined to be:
          \[ L (p, \omega) = \frac{d E_\omega(p)}{d\omega} = \frac{d \Phi(p)}{d\omega \; dA^\bot} \]
          From the definitons above, it follows that the radiance is also flux density
          per unit area per unit solid angle.
        </p>
        <p>
          Now we can define the <b>bidirectional reflectance distribution function</b> [<a href="#Pharr56">2</a>].
          The BRDF is a function $f(p, \omega_r, \omega_i)$ describing the reflection
          from a surface at a point $p$ with incident light from the direction $\omega_i$
          and reflected light exiting in the direction $\omega_r$.
        </p>
        <p>
          As $\omega_r$ and $\omega_i$ are directions in three-dimensional space,
          $f$ is actually a function of four variables and the point $p$. Note that
          $\omega_i$ and $\omega_r$ are both facing away from $p$.
        </p>

        <div class="imagebox" style="width:65%">
          <img src="../../img/hannah/BRDF_input.png" alt="input quantities for BRDF">
          <div class="container" style="width:100%">
            <hr>
            <p>The input parameters of a BRDF are the angles $\theta_i$,
              $\phi_i$, $\theta_r$ and $\phi_r$.</p>
          </div>
        </div>

        <p>
          We want to relate the reflected radiance $L_r(p, \omega_r)$ to the incident
          radiance $L_i(p, \omega_i)$. Recall the definiton of radiance above. We need
          to consider differential cones of directions around $\omega_i$ and $\omega_r$.
        </p>
        <div class="imagebox" style="width:65%">
          <img src="../../img/hannah/BRDF_output.png" alt="output of BRDF">
          <div class="container" style="width:100%">
            <hr>
            <p>Differential cones of directions for $\omega_i$ and $\omega_r$
              needed to define the BRDF in terms of irradiance $E(p, \omega_i)$
              and reflected radiance $L_r(p, \omega_r)$.</p>
          </div>
        </div>

        <p>
          Using the definition of radiance above and Lambert's Law we get:
          \[
            dE(p, \omega_i) = L_i(p, \omega_i)\; cos\; \theta_i \; d\omega_i
          \]
          As we assumed <i> linearity </i> above i.e. more incident light
          corresponds to more reflected light etc., we also know that
          \[
            dL_r(p, \omega_r)\propto dE(p, \omega_i)
          \]
          The BRDF of a surface gives us the constant of proportionality for
          relation above with respect to a point $p$ with incident light from the direction $\omega_i$
          and reflected light exiting in the direction $\omega_r$. The BRDF is
          returns the ratio of differential reflected radiance to differential incident irradiance:
          \[
            f(p, \omega_r, \omega_i) = \frac{dL_r(p, \omega_r)}{dE(p, \omega_i)}
             = \frac{dL_r(p, \omega_r)}{L_i(p, \omega_i)\; cos\; \theta_i \; d\omega_i}
          \]
        </p>
        <p>
          Some important qualities of a BRDF are:
          <ul>
            <li> <b> Reciprocity</b>: Exchanging the directions of incident and
              reflected light does not change the value of the BRDF,
               i.e. $f(p, \omega_r, \omega_i) = f(p, \omega_i, \omega_r)$.
             </li>
             <li> <b> Energy conservation</b>: As in our assumptions above, the
               amount of reflected light is less than or equal to the amount of
               incident light.
          </ul>
          When BRDFs are used in rendering programs, they can be specific to
          the wavelength of light considered ($f_\lambda(p, \omega_r, \omega_i)$).
        </p>
        <hr>
      </section>

      <section id = "diffraction">
        <h2> Diffraction </h2>
        <p>
          In general, surfaces in are not perfectly smooth. When the details
          on the surface have a size similar to the wavelenth of light (visible light
          has a wavelength of 400 to 700nm) diffraction can occur and cause the surface
          to appear in different colors when viewed from different angles, i.e. iridescence.
          A common example are compact discs.
        </p>
        <div class="imagebox" style="width:90%">
          <img src="../../img/hannah/cd_micro.jpg" alt="details of CD surface" style="float:left; width:45%; margin: 2%">
          <img src="../../img/hannah/cd_color.png" alt="CD" style="float:right; width:40%; margin: 2%">
          <p style="clear: both;">
          <div class="container" style="width:100%">
            <hr>
            <p>Micrograph [<a href="cd_micro">3</a>] and photograph [<a href="cd_color">4</a>] of a CD</p>
          </div>
        </div>
        <p>
          We model waves according to the <a href="../../topics/india/IndiaSection.html">
          Huygens-Fresnel Principle </a> and let each peak in the microgeometry of a surface
          be a source of spherical waves. Then it is easy to see that we get different interference
          maxima for different wavelengths, which is why the incident light is split
          into its spectral colors when reflected.
        </p>
        <div class="imagebox" style="width:95%">
          <img src="../../img/hannah/diffraction.png" alt="diffraction on nanostructure">
          <div class="container" style="width:100%">
            <hr>
            <p> Diffraction at surface details</p>
          </div>
        </div>
        <p>
          Such microgeometries are often represented as height fields. A CD surface can be represented
          as a superposition of bumps [<a href="stam">5</a>]. Here is a very simple approach:
          \[
            h(x,y) = \sum_{n = -\infty}^{\infty} \sum_{m = -\infty}^{\infty}
             b(x-x_n, y - y_m)
          \]
          Here $x_n = n \; \Delta x$ is evenly spaced where $\Delta x$ is the distance
          between the $x$ locations and $y_m$ is given by a Poisson distribution specified
          by the density of the bumps on the CD surface. $b$ is the bump function:
          \[
            b(x,y) = h_0 \; g(\frac{x}{a})\; rect(\frac{x}{a}) \;rect(\frac{y}{b})
          \]
          Where $h_0$ is the height of the bumps, $a \leq \Delta x$ the width of the bumps
          and $b$ the length of the bumps, $rect(t)$ is a rectangular function
          that is 1 when $t \in [-\frac{1}{2}, \frac{1}{2}]$ and 0 otherwise. $g$ describes the
          type of the bumps. For a CD with approximately rectangular bumps, $g(t) = 1$ is a
          suffices.
        </p>
        <p>
          Using Fourier transforms, Stam [<a href="stam">5</a>] could analytically develop a
          BRDF to model diffraction on a CD surface.
        </p>
        <div class="imagebox" style="width:50%">
          <img src="../../img/hannah/stam_cd.jpg" alt="rendered CD">
          <div class="container" style="width:100%">
            <hr>
            <p> Rendered image of a CD [<a href="stam">5</a>]</p>
          </div>
        </div>
        <p>
          Natural surfaces like snake skins can also act as a diffraction grating provided
          that the details in their microgeometry have a size similar to the wavelength of
          visible light.

          <!-- new rendering technique summary, example -->
        </p>
        <div class="imagebox" style="width:90%">
          <img src="../../img/hannah/xenopeltis_nat.JPG" alt="xenopeltis">
          <img src="../../img/hannah/xenopeltis.jpg" alt="AFM of xenopeltis skin">
          <div class="container" style="width:100%">
            <hr>
            <p>The skin of a sunbeam snake [<a href="xeno_nat">6</a>] (xenopeltis) under atomic force microscopy [<a href="xeno">7</a>].</p>
          </div>
          <!-- Am I allowed to use this image? -->
        </div>

        <!-- Sciammarella, Cesar A., & Sciammarella, Federico M. (2012). Optical Methods – Interference and Diffraction of Light. In Experimental Mechanics of Solids (pp. 155-181). Chichester, UK: John Wiley & Sons. -->
      </section>

      <!-- Stam, J. (1999). Diffraction shaders. Proceedings of the 26th Annual Conference on Computer Graphics and Interactive Techniques, 101-110. -->
    </div>


    <div class="col-sm-2 sidenav">
      <!-- <div class="well">
        <p>ADS</p>
      </div>
      <div class="well">
        <p>ADS</p>
      </div> -->
    </div>
  </div>
</div>

<footer>
  <h3 class = "text-center">References</h3>
  <ol>
    <li id = "Pharr54"  class = "spaced">
      Pharr, M., & Humphreys, Greg, Ph. D. (2010). 5.4 Radiometry. In: Physically based rendering :
      From theory to implementation (3rd ed.). Amsterdam ; London: Morgan Kaufmann.
    </li>
    <li id="Pharr56"  class = "spaced">
      Pharr, M., & Humphreys, Greg, Ph. D. (2010). 5.6 Surface Reflection. In: Physically based rendering :
      From theory to implementation (3rd ed.). Amsterdam ; London: Morgan Kaufmann.
    </li>
    <li id= "cd_micro" class="spaced">
      https://en.wikipedia.org/wiki/File:Afm_cd-rom.jpg
    </li>
    <li id= "cd_color" class="spaced">
      https://commons.wikimedia.org/wiki/File:CD-ROM.png
    </li>
    <li id= "xeno_nat" class="spaced">
      https://commons.wikimedia.org/wiki/File:Young_sunbeam_snake_from_Thailand.JPG
    </li>
    <li id="stamm" class="spaced">
      Stam, J. (1999). Diffraction shaders. Proceedings of the 26th Annual Conference on Computer Graphics and Interactive Techniques, 101-110.
    </li>
    <li id="xeno" class="spaced">
      Dhillon, Teyssier, Single, Gaponenko, Milinkovitch, & Zwicker. (2014). Interactive Diffraction from Biological Nanostructures. Computer Graphics Forum, 33(8), 177-188.
    </li>
    <li id = "PARDE" class="space">
      Toisoul, A, & Ghosh, A. (2017). Practical Acquisition and Rendering of Diffraction Effects in Surface Reflectance, 1557-7368.
    </li>
  </ol>
</footer>

</body>
</html>
